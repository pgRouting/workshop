<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>4. Energía asequible y limpia &#8212; Workshop - FOSS4G 2022 Firenze - Routing with pgRouting</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="5. Ciudades y comunidades sostenibles" href="sdg11-cities.html" />
    <link rel="prev" title="3. Buena salud y bienestar" href="sdg3-health.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Workshop FOSS4G Firenze</a>
        <span class="navbar-text navbar-version pull-left"><b>2.8</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-1.html">1. Introducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-2.html">2. Sobre El Taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#pgrouting-overview">2.1. Visión General de pgRouting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#osm2pgrouting-overview">2.2. Visión General de osm2pgrouting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#openstreetmap-overview">2.3. Visión general de OpenStreetMap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-3.html">3. Instalación</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-3.html#osgeolive-on-a-virtualbox">3.1. OSGeoLive en una VirtualBox</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basic/data.html">1. Preparar Datos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/data.html#prepare-the-database">1.1. Preparar la base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/data.html#get-the-workshop-data">1.2. Obtenga los Datos del Taller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/data.html#upload-data-to-the-database">1.3. Cargar datos en la base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/data.html#chapter-appendix">1.4. Capítulo: Apéndice</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/pedestrian.html">2. Enrutamiento peatonal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/pedestrian.html#pgr-dijkstra">2.1. pgr_dijkstra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/pedestrian.html#pgr-dijkstracost">2.2. pgr_dijkstraCost</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/vehicle.html">3. Enrutamiento de vehículos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/vehicle.html#routing-for-vehicles">3.1. Ruteo para vehículos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/vehicle.html#cost-manipulations">3.2. Manipulaciones de costes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/sql_function.html">4. Función SQL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/sql_function.html#the-application-requirements">4.1. Los requisitos de aplicación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/sql_function.html#preparing-processing-graphs">4.2. Preparación de grafos de procesamiento</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/sql_function.html#geometry-handling">4.3. Manejo de geometría</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/sql_function.html#creating-the-function">4.4. Crear la función</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/plpgsql_function.html">5. Función pl/pgsql</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/plpgsql_function.html#requirements-for-routing-from-a-to-b">5.1. Requisitos para el ruteo de A a B</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/plpgsql_function.html#the-vertex-table">5.2. La Tabla de Vértices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/plpgsql_function.html#wrk-fromatob-function">5.3. función wrk_fromAtoB</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/appendix.html">6. Apéndice: Soluciones básicas para el taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/appendix.html#solutions-to-pedestrian">6.1. Soluciones a <span class="xref std std-doc">pedestrian</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/appendix.html#solutions-to-vehicle">6.2. Solutions to <span class="xref std std-doc">vehicle</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/appendix.html#solutions-to-sql-function">6.3. Solutions to <span class="xref std std-doc">sql_function</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/appendix.html#solutions-to-plpgsql-function">6.4. Solutions to <span class="xref std std-doc">plpgsql_function</span></a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/chapter-12.html">1. Crear una topología de red</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#load-network-data">1.1. Cargar los datos de la red</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#create-a-routing-network-topology">1.2. Crear una Topología de Red de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#verify-the-routing-network-topology">1.3. Verifique la Topología de Red de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#analyze-and-adjust-the-routing-network-topology">1.4. Analizar y ajustar la Topología de Red de Ruteo</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data.html">1. Datos para los Objetivos de Desarrollo Sostenible</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#work-directory-for-pgrouting-data-manipulation">1.1. Directorio de trabajo para la manipulación de datos de pgRouting</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#mumbai-database">1.2. Base de datos de Mumbai</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#bangladesh-database">1.3. Base de datos de Bangladesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#appendix">1.4. Apéndice</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">2. Alcanzar los Objetivos de Desarrollo Sostenible con pgRouting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#history">2.1. Historia</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#united-nations">2.2. Organización de las Naciones Unidas</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#what-are-the-sustainable-development-goals">2.3. ¿Qué son los Objetivos de Desarrollo Sostenible?</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#target-audience">2.4. Público objetivo</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#prerequisites-for-un-sdg-exercises">2.5. Requisitos previos para los ejercicios de los ODS de ONU</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sdg3-health.html">3. Buena salud y bienestar</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sdg3-health.html#problem-estimation-of-population-served-by-hospitals">3.1. Problema: Estimación de la población atendida por los hospitales</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg3-health.html#pre-processing-roads-and-buildings-data">3.2. Preprocesamiento de datos de caminos y edificios</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg3-health.html#finding-the-roads-served-by-the-hospitals">3.3. Encontrar los caminos atendidos por los hospitales</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg3-health.html#calculating-the-total-population-served-by-the-hospital">3.4. Cálculo de la población total atendida por el hospital</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Energía asequible y limpia</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#problem-optimising-the-electricity-distribution-network">4.1. Problema: Optimización de la red de distribución eléctrica</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-processing-roads-data">4.2. Preprocesamiento de datos de carreteras</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pgr-connectedcomponents-for-preprocessing-roads">4.3. <code class="docutils literal notranslate"><span class="pre">pgr_connectedComponents</span></code> para el preprocesamiento de carreteras</a></li>
<li class="toctree-l2"><a class="reference internal" href="#extract-connected-components-of-roads">4.4. Extraer componentes conectados de carreteras</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pgr-kruskaldfs">4.5. pgr_kruskalDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-10-find-the-minimum-spanning-tree">4.6. Ejercicio 10: Encontrar el árbol de expansión mínimo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparison-between-total-and-optimal-lengths">4.7. Comparación entre longitudes totales y óptimas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-possible-extensions-to-the-exercise">4.8. Otras posibles extensiones al ejercicio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sdg11-cities.html">5. Ciudades y comunidades sostenibles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#problem-city-getting-affected-by-rain-or-not">5.1. Problema: Ciudad afectada por la lluvia o no?</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#choose-a-city">5.2. Eligir una ciudad</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#pre-processing-waterways-data">5.3. Preprocesamiento de datos de vías navegables</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#pgr-connectedcomponents-for-preprocessing-waterways">5.4. <code class="docutils literal notranslate"><span class="pre">pgr_connectedComponents</span></code> para el preprocesamiento de vías navegables</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#exercise-8-get-the-connected-components-of-waterways">5.5. Ejercicio 8: Obtener los componentes conectados de las vías fluviales</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#exercise-9-creating-buffer-around-the-city">5.6. Ejercicio 9: Crear una zona límite alrededor de la ciudad</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#exercise-11-finding-the-components-intersecting-the-buffer">5.7. Ejercicio 11: Encontrar los componentes que intersectan la zona limitada</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#exercise-12-get-the-rain-zones">5.8. Ejercicio 12: Obtener las zonas de lluvia</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdg11-cities.html#exercise-13-create-a-union-of-rain-zones">5.9. Ejercicio 13: Crear una unión de zonas de lluvia</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">6. Apéndice: OSGeo Soluciones del taller de ONU - ODS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#solutions-to-chapter-3-sdg3-health">6.1. Soluciones al Capítulo 3: <span class="xref std std-doc">sdg3-health</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#solutions-to-sdg7-energy">6.2. Soluciones para <span class="xref std std-doc">sdg7-energy</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#solutions-to-sdg11-cities">6.3. Soluciones para <span class="xref std std-doc">sdg11-cities</span></a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-9.html">1. Uso de Qgis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#set-up-qgis">1.1. Configurar QGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#add-a-postgis-layer">1.2. Añadir una Capa postGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#format-a-routing-layer">1.3. Formatear una Capa de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#copy-paste-format">1.4. Copiar/Pegar Formato</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#save-the-project">1.5. Guardar el proyecto</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-10.html">2. Servidor WMS con GeoServer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-10.html#connect-to-the-administration-page">2.1. Conéctese a la página de administración</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-10.html#create-the-layer">2.2. Crear la capa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-11.html">3. Interfaz de Ruteo Basada en OpenLayers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#openlayers-introduction">3.1. Introducción a OpenLayers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#creating-a-minimal-map">3.2. Crear un mapa mínimo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#wms-get-parameters">3.3. Parámetros WMS GET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#select-start-and-destination">3.4. Seleccione «inicio» y «destino»</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#clear-the-results">3.5. Borrar los resultados</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#summary-full-example">3.6. Resumen (ejemplo completo)</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/boost_dijkstra.html">1. Ejemplo de Boost Dijkstra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/hanoslav.html">2. Ejemplos de Internet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/wiki_example.html">3. Ejemplo de Wikipedia Dijkstra</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-2.html">1. Apéndice: Instalación</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-3.html">2. Apéndice: Herramienta de Importación osm2pgrouting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-4.html">3. Tutoriales en Video para Taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-4.html#chapter-4">3.1. Capítulo 4</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">4. Energía asequible y limpia</a><ul>
<li><a class="reference internal" href="#problem-optimising-the-electricity-distribution-network">4.1. Problema: Optimización de la red de distribución eléctrica</a></li>
<li><a class="reference internal" href="#pre-processing-roads-data">4.2. Preprocesamiento de datos de carreteras</a><ul>
<li><a class="reference internal" href="#setting-the-search-path-of-roads">4.2.1. Establecer la ruta de búsqueda de carreteras</a><ul>
<li><a class="reference internal" href="#exercise-1-inspecting-the-current-schemas">4.2.1.1. Ejercicio 1: Inspección de los esquemas</a></li>
<li><a class="reference internal" href="#exercise-2-inspecting-the-current-search-path">4.2.1.2. Ejercicio 2: Inspeccionar la ruta de búsqueda</a></li>
<li><a class="reference internal" href="#exercise-3-fixing-the-current-search-path">4.2.1.3. Ejercicio 3: Arreglar la ruta de búsqueda</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise-4-enumerating-the-tables">4.2.2. Ejercicio 4: Enumerar tablas</a></li>
<li><a class="reference internal" href="#exercise-5-counting-the-number-of-roads">4.2.3. Ejercicio 5: Contar el número de carreteras</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pgr-connectedcomponents-for-preprocessing-roads">4.3. <code class="docutils literal notranslate"><span class="pre">pgr_connectedComponents</span></code> para el preprocesamiento de carreteras</a></li>
<li><a class="reference internal" href="#extract-connected-components-of-roads">4.4. Extraer componentes conectados de carreteras</a><ul>
<li><a class="reference internal" href="#exercise-6-find-the-component-id-for-road-vertices">4.4.1. Ejercicio 6: Buscar el identificador de componente para los vértices de carretera</a></li>
<li><a class="reference internal" href="#exercise-7-finding-the-components-which-are-to-be-removed">4.4.2. Ejercicio 7: Encontrar los componentes que deben eliminarse</a></li>
<li><a class="reference internal" href="#exercise-8-finding-the-road-vertices-of-these-components">4.4.3. Ejercicio 8: Encontrar los vértices de la carretera de estos componentes</a></li>
<li><a class="reference internal" href="#exercise-9-removing-the-unwanted-edges-and-vertices">4.4.4. Ejercicio 9: Eliminación de las aristas y vértices no deseados</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pgr-kruskaldfs">4.5. pgr_kruskalDFS</a></li>
<li><a class="reference internal" href="#exercise-10-find-the-minimum-spanning-tree">4.6. Ejercicio 10: Encontrar el árbol de expansión mínimo</a></li>
<li><a class="reference internal" href="#comparison-between-total-and-optimal-lengths">4.7. Comparación entre longitudes totales y óptimas</a><ul>
<li><a class="reference internal" href="#exercise-11-compute-total-length-of-material-required-in-km">4.7.1. Ejercicio 11: Calcular la longitud total del material requerido en km</a></li>
<li><a class="reference internal" href="#exercise-12-compute-total-length-of-roads">4.7.2. Ejercicio 12: Calcular la longitud total de las carreteras</a></li>
</ul>
</li>
<li><a class="reference internal" href="#further-possible-extensions-to-the-exercise">4.8. Otras posibles extensiones al ejercicio</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="sdg3-health.html" title="Previous Chapter: 3. Buena salud y bienestar"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 3. Buena salu...</span>
    </a>
  </li>
  <li>
    <a href="sdg11-cities.html" title="Next Chapter: 5. Ciudades y comunidades sostenibles"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">5. Ciudades y... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="affordable-and-clean-energy">
<h1><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">4. </span>Energía asequible y limpia</a><a class="headerlink" href="#affordable-and-clean-energy" title="Enlace permanente a este encabezado">¶</a></h1>
<p>“Energía asequible y limpia” es el 7º Objetivo de Desarrollo Sostenible 11. Aspira a garantizar el acceso a una energía «asequible, fiable, sostenible» y «moderna» para todos. Hoy en día, la energía renovable está logrando ganancias impresionantes en el sector eléctrico. A medida que se construyan más y más nuevos asentamientos, se desarrollará una nueva red de distribución de electricidad. La distribución de electricidad es una infraestructura muy costosa. Encontrar el camino óptimo para colocar esta infraestructura es crucial para mantener la asequibilidad de la electricidad para todos. Este ejercicio se centra en encontrar esta ruta / red óptima para colocar el equipo de distribución de electricidad.</p>
<img alt="Objetivo de Desarrollo Sostenible 7: Energía asequible y limpia" class="align-center" src="../_images/un_sdg7.png" />
<p>“Fuente de la imagen &lt;<a class="reference external" href="https://sdgs.un.org/goals/goal7">https://sdgs.un.org/goals/goal7</a>&gt;`__</p>
<nav class="contents" id="chapter-contents">
<p class="topic-title">Contenido del Capítulo</p>
<ul class="simple">
<li><p><a class="reference internal" href="#affordable-and-clean-energy" id="id1">Energía asequible y limpia</a></p>
<ul>
<li><p><a class="reference internal" href="#problem-optimising-the-electricity-distribution-network" id="id2">Problema: Optimización de la red de distribución eléctrica</a></p></li>
<li><p><a class="reference internal" href="#pre-processing-roads-data" id="id3">Preprocesamiento de datos de carreteras</a></p>
<ul>
<li><p><a class="reference internal" href="#setting-the-search-path-of-roads" id="id4">Establecer la ruta de búsqueda de carreteras</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-1-inspecting-the-current-schemas" id="id5">Ejercicio 1: Inspección de los esquemas</a></p></li>
<li><p><a class="reference internal" href="#exercise-2-inspecting-the-current-search-path" id="id6">Ejercicio 2: Inspeccionar la ruta de búsqueda</a></p></li>
<li><p><a class="reference internal" href="#exercise-3-fixing-the-current-search-path" id="id7">Ejercicio 3: Arreglar la ruta de búsqueda</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#exercise-4-enumerating-the-tables" id="id8">Ejercicio 4: Enumerar tablas</a></p></li>
<li><p><a class="reference internal" href="#exercise-5-counting-the-number-of-roads" id="id9">Ejercicio 5: Contar el número de carreteras</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#pgr-connectedcomponents-for-preprocessing-roads" id="id10"><code class="docutils literal notranslate"><span class="pre">pgr_connectedComponents</span></code> para el preprocesamiento de carreteras</a></p></li>
<li><p><a class="reference internal" href="#extract-connected-components-of-roads" id="id11">Extraer componentes conectados de carreteras</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-6-find-the-component-id-for-road-vertices" id="id12">Ejercicio 6: Buscar el identificador de componente para los vértices de carretera</a></p></li>
<li><p><a class="reference internal" href="#exercise-7-finding-the-components-which-are-to-be-removed" id="id13">Ejercicio 7: Encontrar los componentes que deben eliminarse</a></p></li>
<li><p><a class="reference internal" href="#exercise-8-finding-the-road-vertices-of-these-components" id="id14">Ejercicio 8: Encontrar los vértices de la carretera de estos componentes</a></p></li>
<li><p><a class="reference internal" href="#exercise-9-removing-the-unwanted-edges-and-vertices" id="id15">Ejercicio 9: Eliminación de las aristas y vértices no deseados</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#pgr-kruskaldfs" id="id16">pgr_kruskalDFS</a></p></li>
<li><p><a class="reference internal" href="#exercise-10-find-the-minimum-spanning-tree" id="id17">Ejercicio 10: Encontrar el árbol de expansión mínimo</a></p></li>
<li><p><a class="reference internal" href="#comparison-between-total-and-optimal-lengths" id="id18">Comparación entre longitudes totales y óptimas</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-11-compute-total-length-of-material-required-in-km" id="id19">Ejercicio 11: Calcular la longitud total del material requerido en km</a></p></li>
<li><p><a class="reference internal" href="#exercise-12-compute-total-length-of-roads" id="id20">Ejercicio 12: Calcular la longitud total de las carreteras</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#further-possible-extensions-to-the-exercise" id="id21">Otras posibles extensiones al ejercicio</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="problem-optimising-the-electricity-distribution-network">
<h2><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">4.1. </span>Problema: Optimización de la red de distribución eléctrica</a><a class="headerlink" href="#problem-optimising-the-electricity-distribution-network" title="Enlace permanente a este encabezado">¶</a></h2>
<p><strong>Declaración del problema</strong></p>
<p>Determinar la menor longitud del camino para la colocación del equipo de distribución de electricidad de tal manera que cada edificio sea atendido.</p>
<a class="reference internal image-reference" href="../_images/sdg7_output.png"><img alt="../_images/sdg7_output.png" class="align-center" src="../_images/sdg7_output.png" style="width: 268.0px; height: 275.0px;" /></a>
<p><strong>Idea central</strong></p>
<p>Es posible que las líneas eléctricas no estén en todas las carreteras de la ciudad. En una red de carreteras compleja de una ciudad, la red se puede optimizar para una longitud menor, de modo que las líneas eléctricas lleguen a todas las localidades de la ciudad. Menor longitud conduce a una mayor rentabilidad, lo que resulta en electricidad asequible.</p>
<p><strong>Enfoque</strong></p>
<ul class="simple">
<li><p>Extraer componentes conectados de carreteras</p></li>
<li><p>Usar pgRouting para encontrar el árbol de expansión mínimo</p></li>
<li><p>Comparar la longitud total de las carreteras y el árbol de expansión mínimo</p></li>
</ul>
</section>
<section id="pre-processing-roads-data">
<h2><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">4.2. </span>Preprocesamiento de datos de carreteras</a><a class="headerlink" href="#pre-processing-roads-data" title="Enlace permanente a este encabezado">¶</a></h2>
<p>First step is to pre-process the data obtained from <a class="reference internal" href="data.html#data-for-sustainable-development-goals"><span class="std std-ref">Datos para los Objetivos de Desarrollo Sostenible</span></a>.
This section will work the graph that is going to be used for processing. While
building the graph, the data has to be inspected to determine if there is any
invalid data. This is a very important step to make sure that the data is of
required quality. pgRouting can also be used to do some Data Adjustments.
This will be discussed in further sections.</p>
<section id="setting-the-search-path-of-roads">
<h3><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">4.2.1. </span>Establecer la ruta de búsqueda de carreteras</a><a class="headerlink" href="#setting-the-search-path-of-roads" title="Enlace permanente a este encabezado">¶</a></h3>
<p>El primer paso en el preprocesamiento es establecer la ruta de búsqueda para los datos de <code class="docutils literal notranslate"><span class="pre">Carreteras</span></code>. La ruta de búsqueda es una lista de esquemas que ayuda al sistema a determinar cómo se va a importar una tabla en particular.</p>
<section id="exercise-1-inspecting-the-current-schemas">
<h4><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">4.2.1.1. </span>Ejercicio 1: Inspección de los esquemas</a><a class="headerlink" href="#exercise-1-inspecting-the-current-schemas" title="Enlace permanente a este encabezado">¶</a></h4>
<p>Inspeccione los esquemas mostrando todos los esquemas actuales mediante el siguiente comando</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="se">\d</span>n
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">   </span>List<span class="w"> </span>of<span class="w"> </span>schemas
<span class="w">   </span>Name<span class="w">    </span><span class="p">|</span><span class="w">  </span>Owner
-----------+----------
<span class="w"> </span>public<span class="w">    </span><span class="p">|</span><span class="w"> </span>postgres
<span class="w"> </span>roads<span class="w">     </span><span class="p">|</span><span class="w"> </span>&lt;user-name&gt;
<span class="o">(</span><span class="m">2</span><span class="w"> </span>rows<span class="o">)</span>
</pre></div>
</div>
<p>Los nombres de esquema son <code class="docutils literal notranslate"><span class="pre">roads</span></code> and <code class="docutils literal notranslate"><span class="pre">public</span></code>. El propietario depende de quién tiene los derechos de la base de datos.</p>
</section>
<section id="exercise-2-inspecting-the-current-search-path">
<h4><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">4.2.1.2. </span>Ejercicio 2: Inspeccionar la ruta de búsqueda</a><a class="headerlink" href="#exercise-2-inspecting-the-current-search-path" title="Enlace permanente a este encabezado">¶</a></h4>
<p>Mostrar la ruta de búsqueda actual mediante la siguiente consulta.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SHOW<span class="w"> </span>search_path<span class="p">;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">   </span>search_path
-----------------
<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$user</span><span class="s2">&quot;</span>,<span class="w"> </span>public
<span class="o">(</span><span class="m">1</span><span class="w"> </span>row<span class="o">)</span>
</pre></div>
</div>
<p>Esta es la ruta de búsqueda actual. No se puede acceder a las tablas mediante esta opción.</p>
</section>
<section id="exercise-3-fixing-the-current-search-path">
<h4><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">4.2.1.3. </span>Ejercicio 3: Arreglar la ruta de búsqueda</a><a class="headerlink" href="#exercise-3-fixing-the-current-search-path" title="Enlace permanente a este encabezado">¶</a></h4>
<p>En este caso, la tabla de rutas de búsqueda de carreteras se establece en el esquema “<code class="docutils literal notranslate"><span class="pre">roads</span></code> . La siguiente consulta se utiliza para corregir la ruta de búsqueda</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SET</span><span class="w"> </span><span class="n">search_path</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">roads</span><span class="p">,</span><span class="k">public</span><span class="p">;</span>
<span class="k">SHOW</span><span class="w"> </span><span class="n">search_path</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">    </span>search_path
-------------------
<span class="w"> </span>roads,<span class="w"> </span>public
<span class="o">(</span><span class="m">1</span><span class="w"> </span>row<span class="o">)</span>
</pre></div>
</div>
</section>
</section>
<section id="exercise-4-enumerating-the-tables">
<h3><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">4.2.2. </span>Ejercicio 4: Enumerar tablas</a><a class="headerlink" href="#exercise-4-enumerating-the-tables" title="Enlace permanente a este encabezado">¶</a></h3>
<p>Finalmente, <cite>dt`</cite> se utiliza para verificar si el esquema se ha cambiado correctamente.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="se">\d</span>t
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">                     </span>List<span class="w"> </span>of<span class="w"> </span>relations
<span class="w">  </span>Schema<span class="w">   </span><span class="p">|</span><span class="w">            </span>Name<span class="w">             </span><span class="p">|</span><span class="w"> </span>Type<span class="w">  </span><span class="p">|</span><span class="w">  </span>Owner
-----------+-----------------------------+-------+---------
<span class="w"> </span>public<span class="w">    </span><span class="p">|</span><span class="w"> </span>spatial_ref_sys<span class="w">             </span><span class="p">|</span><span class="w"> </span>table<span class="w"> </span><span class="p">|</span><span class="w"> </span>&lt;user-name&gt;
<span class="w"> </span>roads<span class="w">     </span><span class="p">|</span><span class="w"> </span>configuration<span class="w">               </span><span class="p">|</span><span class="w"> </span>table<span class="w"> </span><span class="p">|</span><span class="w"> </span>user
<span class="w"> </span>roads<span class="w">     </span><span class="p">|</span><span class="w"> </span>roads_pointsofinterest<span class="w">      </span><span class="p">|</span><span class="w"> </span>table<span class="w"> </span><span class="p">|</span><span class="w"> </span>user
<span class="w"> </span>roads<span class="w">     </span><span class="p">|</span><span class="w"> </span>roads_ways<span class="w">                  </span><span class="p">|</span><span class="w"> </span>table<span class="w"> </span><span class="p">|</span><span class="w"> </span>user
<span class="w"> </span>roads<span class="w">     </span><span class="p">|</span><span class="w"> </span>roads_ways_vertices_pgr<span class="w">     </span><span class="p">|</span><span class="w"> </span>table<span class="w"> </span><span class="p">|</span><span class="w"> </span>user
<span class="o">(</span><span class="m">5</span><span class="w"> </span>rows<span class="o">)</span>
</pre></div>
</div>
</section>
<section id="exercise-5-counting-the-number-of-roads">
<h3><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">4.2.3. </span>Ejercicio 5: Contar el número de carreteras</a><a class="headerlink" href="#exercise-5-counting-the-number-of-roads" title="Enlace permanente a este encabezado">¶</a></h3>
<p>La importancia de contar la información en este taller es asegurarse de que se utilizan los mismos datos y, en consecuencia, los resultados son los mismos. Además, algunas de las filas se pueden ver para comprender la estructura de la tabla y cómo se almacenan los datos en ella.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">-- Counting the number of Edges of roads</span>
<span class="linenos">2</span><span class="k">SELECT</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways</span><span class="p">;</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="c1">-- Counting the number of Vertices of roads</span>
<span class="linenos">5</span><span class="k">SELECT</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="p">;</span>
</pre></div>
</div>
<p><a class="reference internal" href="appendix.html#exercise-5-chapter-sdg-7"><span class="std std-ref">Ejercicio: 5 (Capítulo: ODS 7)</span></a></p>
</section>
</section>
<section id="pgr-connectedcomponents-for-preprocessing-roads">
<h2><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">4.3. </span><code class="docutils literal notranslate"><span class="pre">pgr_connectedComponents</span></code> para el preprocesamiento de carreteras</a><a class="headerlink" href="#pgr-connectedcomponents-for-preprocessing-roads" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Para el siguiente paso se utilizará <code class="docutils literal notranslate"><span class="pre">pgr_connectedComponents</span></code>. Se utiliza para encontrar los componentes conectados de un grafo no dirigido utilizando un enfoque basado en la búsqueda en profundidad.</p>
<p><strong>Firmas</strong></p>
<div class="highlight-none notranslate" id="index-0"><div class="highlight"><pre><span></span>pgr_connectedComponents(edges_sql)

RETURNS SET OF (seq, component, node)
OR EMPTY SET
</pre></div>
</div>
<p>Para más información la documentation de <a class="reference external" href="https://docs.pgrouting.org/3.1/en/pgr_connectedComponents.html">pgr_connectedComponents</a> puede se emcotrada en esta liga..</p>
</section>
<section id="extract-connected-components-of-roads">
<h2><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">4.4. </span>Extraer componentes conectados de carreteras</a><a class="headerlink" href="#extract-connected-components-of-roads" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Similar to <a class="reference internal" href="sdg3-health.html"><span class="doc">Buena salud y bienestar</span></a>, the disconnected roads
have to be removed from their network to get appropriate results.</p>
<p>Siga los pasos que se indican a continuación para completar esta tarea.</p>
<section id="exercise-6-find-the-component-id-for-road-vertices">
<h3><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">4.4.1. </span>Ejercicio 6: Buscar el identificador de componente para los vértices de carretera</a><a class="headerlink" href="#exercise-6-find-the-component-id-for-road-vertices" title="Enlace permanente a este encabezado">¶</a></h3>
<p>El primer paso en preprocesamiento de carreteras es encontrar el identificador de componente conectado para los vértices de carretera. Siga los pasos que se indican a continuación para completar esta tarea.</p>
<ol class="arabic simple">
<li><p>Agregue una columna denominada “<code class="docutils literal notranslate"><span class="pre">component</span></code> para almacenar el número de componente.</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span>
<span class="linenos">2</span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">;</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Actualice la columna “<cite>component`</cite> en <code class="docutils literal notranslate"><span class="pre">roads_ways_vertices_pgr</span></code> en el número de componente</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">UPDATE</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="w"> </span>
<span class="linenos">2</span><span class="k">SET</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subquery</span><span class="p">.</span><span class="n">component</span>
<span class="linenos">3</span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="linenos">4</span><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pgr_connectedComponents</span><span class="p">(</span>
<span class="linenos">5</span><span class="w">		</span><span class="s1">&#39;SELECT gid AS id, source, target, cost, reverse_cost </span>
<span class="linenos">6</span><span class="s1">		FROM roads_ways&#39;</span><span class="p">)</span>
<span class="linenos">7</span><span class="w">		</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">8</span><span class="k">AS</span><span class="w"> </span><span class="n">subquery</span>
<span class="linenos">9</span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
</pre></div>
</div>
<p>Esto almacenará el número del componente de cada segmento en la tabla. Ahora, la red de carreteras completamente conectada debería tener el recuento máximo en la tabla <code class="docutils literal notranslate"><span class="pre">component</span></code>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>if done before: <a class="reference internal" href="appendix.html#exercise-10-chapter-sdg-3"><span class="std std-ref">Ejercicio: 10 (Capítulo: ODS 3)</span></a>
if not done before: <a class="reference internal" href="appendix.html#exercise-6-chapter-sdg-7"><span class="std std-ref">Ejercicio: 6 (Capítulo: ODS 7)</span></a></p>
</section>
<section id="exercise-7-finding-the-components-which-are-to-be-removed">
<h3><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">4.4.2. </span>Ejercicio 7: Encontrar los componentes que deben eliminarse</a><a class="headerlink" href="#exercise-7-finding-the-components-which-are-to-be-removed" title="Enlace permanente a este encabezado">¶</a></h3>
<p>Esta consulta selecciona todos los componentes que no son iguales al número de componente con el recuento máximo mediante una subconsulta que agrupa las filas en <code class="docutils literal notranslate"><span class="pre">roads_ways_vertices_pgr</span></code> por componentes.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">WITH</span>
<span class="linenos"> 2</span><span class="n">subquery</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 3</span><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 4</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="w"> </span>
<span class="linenos"> 5</span><span class="w">	</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">component</span>
<span class="linenos"> 6</span><span class="w">	</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="k">SELECT</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">subquery</span><span class="w"> </span>
<span class="linenos"> 8</span><span class="k">WHERE</span><span class="w"> </span><span class="k">count</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 9</span><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">subquery</span>
<span class="linenos">10</span><span class="p">);</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>if done before: <a class="reference internal" href="appendix.html#exercise-11-chapter-sdg-3"><span class="std std-ref">Ejercicio: 11 (Capítulo: ODS 3)</span></a>
if not done before: <a class="reference internal" href="appendix.html#exercise-7-chapter-sdg-7"><span class="std std-ref">Ejercicio: 7 (Capítulo: ODS 7)</span></a></p>
</section>
<section id="exercise-8-finding-the-road-vertices-of-these-components">
<h3><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">4.4.3. </span>Ejercicio 8: Encontrar los vértices de la carretera de estos componentes</a><a class="headerlink" href="#exercise-8-finding-the-road-vertices-of-these-components" title="Enlace permanente a este encabezado">¶</a></h3>
<p>Encontar los vértices de la carretera si estos componentes pertenecen a los componentes que se van a eliminar. La siguiente consulta selecciona todos los vértices de carretera que tienen el número de componente del ejercicio 7.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">WITH</span>
<span class="linenos"> 2</span><span class="n">subquery</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 3</span><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 4</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="w"> </span>
<span class="linenos"> 5</span><span class="w">	</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">component</span><span class="p">),</span>
<span class="linenos"> 6</span><span class="w">	</span><span class="n">to_remove</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 7</span><span class="w">		</span><span class="k">SELECT</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">subquery</span><span class="w"> </span>
<span class="linenos"> 8</span><span class="w">		</span><span class="k">WHERE</span><span class="w"> </span><span class="k">count</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 9</span><span class="w">		</span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">subquery</span>
<span class="linenos">10</span><span class="w">	</span><span class="p">)</span>
<span class="linenos">11</span><span class="p">)</span>
<span class="linenos">12</span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="w"> </span>
<span class="linenos">13</span><span class="k">WHERE</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">to_remove</span><span class="p">);</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>if done before: <a class="reference internal" href="appendix.html#exercise-12-chapter-sdg-3"><span class="std std-ref">Ejercicio: 12 (Capítulo: ODS 3)</span></a>
if not done before: <a class="reference internal" href="appendix.html#exercise-8-chapter-sdg-7"><span class="std std-ref">Ejercicio: 8 (Capítulo: ODS 7)</span></a></p>
</section>
<section id="exercise-9-removing-the-unwanted-edges-and-vertices">
<h3><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">4.4.4. </span>Ejercicio 9: Eliminación de las aristas y vértices no deseados</a><a class="headerlink" href="#exercise-9-removing-the-unwanted-edges-and-vertices" title="Enlace permanente a este encabezado">¶</a></h3>
<ol class="arabic simple">
<li><p>Eliminación de los segmentos no deseados</p></li>
</ol>
<p>En la tabla “<cite>roads_ways`</cite> (tabla de segmentos) <code class="docutils literal notranslate"><span class="pre">source</span></code> y <code class="docutils literal notranslate"><span class="pre">target</span></code> tienen el <code class="docutils literal notranslate"><span class="pre">id</span></code> de los vértices desde donde comienza y termina lel segmento. Para eliminar todas las aristas desconectadas, la siguiente consulta toma el resultado de la consulta del paso 4 y elimina todas las aristas que tienen el mismo <cite>source`</cite> como el <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">source</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 2</span><span class="w">		</span><span class="k">WITH</span>
<span class="linenos"> 3</span><span class="w">		</span><span class="n">subquery</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 4</span><span class="w">			</span><span class="k">SELECT</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 5</span><span class="w">			</span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="w"> </span>
<span class="linenos"> 6</span><span class="w">			</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">component</span>
<span class="linenos"> 7</span><span class="w">			</span><span class="p">),</span>
<span class="linenos"> 8</span><span class="w">		</span><span class="n">to_remove</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 9</span><span class="w">			</span><span class="k">SELECT</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">subquery</span><span class="w"> </span>
<span class="linenos">10</span><span class="w">			</span><span class="k">WHERE</span><span class="w"> </span><span class="k">count</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span>
<span class="linenos">11</span><span class="w">				</span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">subquery</span>
<span class="linenos">12</span><span class="w">				</span><span class="p">)</span>
<span class="linenos">13</span><span class="w">	</span><span class="p">)</span>
<span class="linenos">14</span><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="w"> </span>
<span class="linenos">15</span><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">to_remove</span><span class="p">)</span>
<span class="linenos">16</span><span class="p">);</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Eliminación de vértices no utilizados</p></li>
</ol>
<p>La siguiente consulta utiliza el resultado del paso 4 para eliminar los vértices de los segmentos desconectados.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">WITH</span>
<span class="linenos"> 2</span><span class="n">subquery</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 3</span><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 4</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="w"> </span>
<span class="linenos"> 5</span><span class="w">	</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">component</span>
<span class="linenos"> 6</span><span class="w">	</span><span class="p">),</span>
<span class="linenos"> 7</span><span class="w">	</span><span class="n">to_remove</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 8</span><span class="w">		</span><span class="k">SELECT</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">subquery</span><span class="w"> </span>
<span class="linenos"> 9</span><span class="w">		</span><span class="k">WHERE</span><span class="w"> </span><span class="k">count</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">subquery</span><span class="p">)</span>
<span class="linenos">10</span><span class="w">		</span><span class="p">)</span>
<span class="linenos">11</span><span class="w">	</span><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways_vertices_pgr</span><span class="w"> </span>
<span class="linenos">12</span><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">to_remove</span>
<span class="linenos">13</span><span class="p">);</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>if done before: <a class="reference internal" href="appendix.html#exercise-13-chapter-sdg-3"><span class="std std-ref">Ejercicio: 13 (Capítulo: ODS 3)</span></a>
if not done before: <a class="reference internal" href="appendix.html#exercise-9-chapter-sdg-7"><span class="std std-ref">Ejercicio: 9 (Capítulo: ODS 7)</span></a></p>
</section>
</section>
<section id="pgr-kruskaldfs">
<h2><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">4.5. </span>pgr_kruskalDFS</a><a class="headerlink" href="#pgr-kruskaldfs" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Para el siguiente paso se utilizará <code class="docutils literal notranslate"><span class="pre">pgr_kruskalDFS</span></code>. El algoritmo de Kruskal se utiliza para obtener el árbol de expansión mínimo con el orden de búsqueda de profundidad primero. Un árbol de expansión mínimo (MST) es un subconjunto de aristas de un grafo conectado no dirigido que conecta todos los vértices juntos, sin ningún ciclo, tal que la suma de los pesos de las aristas sea lo más pequeña posible.</p>
<p class="rubric">Firmas</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_kruskalDFS(Edges SQL, Root vid [, max_depth])
pgr_kruskalDFS(Edges SQL, Root vids [, max_depth])

RETURNS SET OF (seq, depth, start_vid, node, edge, cost, agg_cost)
</pre></div>
</div>
<p class="rubric" id="index-1">Un solo vértice</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_kruskalDFS(Edges SQL, Root vid [, max_depth])

RETURNS SET OF (seq, depth, start_vid, node, edge, cost, agg_cost)
</pre></div>
</div>
<p class="rubric">Múltiples vértices</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_kruskalDFS(Edges SQL, Root vids [, max_depth])

RETURNS SET OF (seq, depth, start_vid, node, edge, cost, agg_cost)
</pre></div>
</div>
<p>Para más información la documentation de <a class="reference external" href="https://docs.pgrouting.org/3.1/en/pgr_kruskalDFS.html">pgr_kruskalDFS</a> puede se emcotrada en esta liga..</p>
</section>
<section id="exercise-10-find-the-minimum-spanning-tree">
<h2><a class="toc-backref" href="#id17" role="doc-backlink"><span class="section-number">4.6. </span>Ejercicio 10: Encontrar el árbol de expansión mínimo</a><a class="headerlink" href="#exercise-10-find-the-minimum-spanning-tree" title="Enlace permanente a este encabezado">¶</a></h2>
<p>La red de carreteras tiene un bosque de expansión mínimo que es una unión de los árboles de expansión mínimos para sus componentes conectados. Este bosque de expansión mínimo es la red óptima de componentes de distribución de electricidad.</p>
<p>Para completar esta tarea, ejecute la consulta siguiente.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">SELECT</span><span class="w"> </span><span class="k">source</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">the_geom</span>
<span class="linenos">2</span><span class="k">FROM</span><span class="w"> </span><span class="n">pgr_kruskalDFS</span><span class="p">(</span>
<span class="linenos">3</span><span class="w">    </span><span class="s1">&#39;SELECT gid AS id, source, target, cost, reverse_cost, the_geom </span>
<span class="linenos">4</span><span class="s1">    FROM roads.roads_ways ORDER BY id&#39;</span><span class="p">,</span>
<span class="linenos">5</span><span class="w">    </span><span class="mi">91</span><span class="p">),</span><span class="w"> </span>
<span class="linenos">6</span><span class="n">roads</span><span class="p">.</span><span class="n">roads_ways</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">r</span>
<span class="linenos">7</span><span class="k">WHERE</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">gid</span>
<span class="linenos">8</span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
<p>La siguiente consulta dará los resultados con el vértice de origen, el vértice de destino, el identificador del segmento, y el costo agregado.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">SELECT</span><span class="w"> </span><span class="k">source</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="n">agg_cost</span>
<span class="linenos">2</span><span class="k">FROM</span><span class="w"> </span><span class="n">pgr_kruskalDFS</span><span class="p">(</span>
<span class="linenos">3</span><span class="w">    </span><span class="s1">&#39;SELECT gid AS id, source, target, cost, reverse_cost, the_geom </span>
<span class="linenos">4</span><span class="s1">    FROM roads.roads_ways </span>
<span class="linenos">5</span><span class="s1">    ORDER BY id&#39;</span><span class="p">,</span><span class="mi">91</span><span class="p">),</span><span class="w"> </span>
<span class="linenos">6</span><span class="n">roads</span><span class="p">.</span><span class="n">roads_ways</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">r</span>
<span class="linenos">7</span><span class="k">WHERE</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">gid</span><span class="w"> </span>
<span class="linenos">8</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">agg_cost</span>
<span class="linenos">9</span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p><code class="docutils literal notranslate"><span class="pre">LIMIT</span> <span class="pre">10</span></code> muestra las primeras 10 filas de la salida.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><a class="reference internal" href="appendix.html#exercise-10-chapter-sdg-7"><span class="std std-ref">Ejercicio: 10 (Capítulo: ODS 7)</span></a></p>
</section>
<section id="comparison-between-total-and-optimal-lengths">
<h2><a class="toc-backref" href="#id18" role="doc-backlink"><span class="section-number">4.7. </span>Comparación entre longitudes totales y óptimas</a><a class="headerlink" href="#comparison-between-total-and-optimal-lengths" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Las longitudes totales de la red y el árbol de expansión mínimo se pueden comparar para ver la diferencia entre ambos. Para hacerlo, siga los pasos a continuación:</p>
<section id="exercise-11-compute-total-length-of-material-required-in-km">
<h3><a class="toc-backref" href="#id19" role="doc-backlink"><span class="section-number">4.7.1. </span>Ejercicio 11: Calcular la longitud total del material requerido en km</a><a class="headerlink" href="#exercise-11-compute-total-length-of-material-required-in-km" title="Enlace permanente a este encabezado">¶</a></h3>
<p>Calcular la longitud total del árbol de expansión mínimo, que es una estimación de la longitud total del material requerido.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">length_m</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="w"> </span>
<span class="linenos"> 2</span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="linenos"> 3</span><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="k">source</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="n">agg_cost</span><span class="p">,</span><span class="n">r</span><span class="p">.</span><span class="n">length_m</span><span class="w">             </span>
<span class="linenos"> 4</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">pgr_kruskalDFS</span><span class="p">(</span>
<span class="linenos"> 5</span><span class="w">		</span><span class="s1">&#39;SELECT gid AS id, source, target, cost, reverse_cost, the_geom </span>
<span class="linenos"> 6</span><span class="s1">		FROM roads.roads_ways </span>
<span class="linenos"> 7</span><span class="s1">		ORDER BY id&#39;</span><span class="p">,</span><span class="mi">91</span><span class="p">),</span><span class="w"> </span>
<span class="linenos"> 8</span><span class="w">	</span><span class="n">roads</span><span class="p">.</span><span class="n">roads_ways</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">r</span>
<span class="linenos"> 9</span><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">gid</span><span class="w"> </span>
<span class="linenos">10</span><span class="w">	</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">agg_cost</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">11</span><span class="k">AS</span><span class="w"> </span><span class="n">subquery</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>“<code class="docutils literal notranslate"><span class="pre">(length_m)/1000</span></code>  se utiliza para encontrar la longitud en kilómetros</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><a class="reference internal" href="appendix.html#exercise-11-chapter-sdg-7"><span class="std std-ref">Ejercicio: 11 (Capítulo: ODS 7)</span></a></p>
</section>
<section id="exercise-12-compute-total-length-of-roads">
<h3><a class="toc-backref" href="#id20" role="doc-backlink"><span class="section-number">4.7.2. </span>Ejercicio 12: Calcular la longitud total de las carreteras</a><a class="headerlink" href="#exercise-12-compute-total-length-of-roads" title="Enlace permanente a este encabezado">¶</a></h3>
<p>Calcular la longitud total de la red de carreteras del área dada.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">length_m</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">roads_ways</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>“<code class="docutils literal notranslate"><span class="pre">(length_m)/1000</span></code>  se utiliza para encontrar la longitud en kilómetros</p>
</div>
<p>Para esta área estamos obteniendo los siguientes resultados:</p>
<ul class="simple">
<li><p>Longitud total de la carretera: <code class="docutils literal notranslate"><span class="pre">55.68</span> <span class="pre">km</span></code></p></li>
<li><p>Longitud óptima de la red: “<code class="docutils literal notranslate"><span class="pre">29.89</span> <span class="pre">km</span></code></p></li>
</ul>
<p>La longitud del árbol de expansión mínima es aproximadamente la mitad de la longitud de la red total de carreteras.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><a class="reference internal" href="appendix.html#exercise-12-chapter-sdg-7"><span class="std std-ref">Ejercicio: 12 (Capítulo: ODS 7)</span></a></p>
</section>
</section>
<section id="further-possible-extensions-to-the-exercise">
<h2><a class="toc-backref" href="#id21" role="doc-backlink"><span class="section-number">4.8. </span>Otras posibles extensiones al ejercicio</a><a class="headerlink" href="#further-possible-extensions-to-the-exercise" title="Enlace permanente a este encabezado">¶</a></h2>
<ul class="simple">
<li><p>Encontrar la red óptima de carreteras de tal manera que llegue a todos los edificios</p></li>
<li><p>Encontrar el número y la ubicación óptimos de los transformadores de electricidad</p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2022 Daniel Kastl, Vicky Vergara, Rajat Shinde.<br/>
      Actualizado por última vez en mar 13, 2023.<br/>
    </p>
  </div>
</footer>
  </body>
</html>